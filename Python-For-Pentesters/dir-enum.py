#!/usr/bin/env python3.10

from argparse import ArgumentParser, Namespace
from requests import get
from time import perf_counter
from colorama import Fore 


def get_directories(wordlist: str) -> list:
    with open(str(wordlist), 'r') as wordlist_file:
        directories = [line.replace('\n', '') for line in wordlist_file.readlines()]
        
    return directories


def parse_args() -> Namespace:
    parser = ArgumentParser(description="Directory-Enum.py URL LIST")
    parser.add_argument('url', help='URL')
    parser.add_argument('wordlist', help='Specify a wordlist')
    parser.add_argument('-v', '--verbose', help='verbose mode', action='store_true')
    return parser.parse_args()


def fuzz_all(directories: list) -> None:
    for directory in directories:
        if args.verbose:
            print(f'{Fore.GREEN}\rtrying: {url}/{directory.lower()}{Fore.RESET}\t\t\t', end='')
        if get(f'{url}/{directory.lower()}').status_code != 404:
            print(f'{Fore.RED}{url}/{directory.lower()}{Fore.RESET}')


if __name__ == "__main__":
    start = perf_counter()
    args = parse_args()
    url = str(args.url).removesuffix('/')
    url = f"http://{url}" if 'http' not in url else url  #! Checking http and https 
    print(f'{Fore.YELLOW}Start Fuzzing {url}{Fore.RESET}')
    fuzz_all(get_directories(args.wordlist))
    end = perf_counter()
    print(end-start)
    