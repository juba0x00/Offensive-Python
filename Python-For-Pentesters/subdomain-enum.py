from sys import argv
from requests import get, ConnectionError
from time import perf_counter
from argparse import ArgumentParser, Namespace
from colorama import Fore
start = perf_counter()


def parse_arguments() -> Namespace:
    parser = ArgumentParser()
    parser.add_argument('root_domain', help='root domain: site.com')
    parser.add_argument('wordlist_file', help='wordlist file name')
    parser.add_argument('-v', '--verbose', action='store_true', help='enable verbosity')
    return parser.parse_args()




def load_wordlist(filename):
    # load the wordlist from a file 
    with open(filename, 'r') as file:
        return file.readlines()
   

def enum(root_domain: str, wordlist: list) -> None:
    for subdomain in wordlist:
        try:
            if args.verbose:
                print(f'{Fore.GREEN}http://{subdomain[:-1]}.{root_domain}{Fore.RESET}')
            get(f'http://{subdomain[:-1]}.{root_domain}')
            
        except ConnectionError:
            pass
        
        else:
            pass
            print(f'{Fore.RED}Valid subDomain: {Fore.RESET}', subdomain)
        
        
        
if __name__ == '__main__':
    args = parse_arguments()
    wordlist = load_wordlist(args.wordlist_file)
    enum(args.root_domain, wordlist)
    end = perf_counter()
    print(end-start)