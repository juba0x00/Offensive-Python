#!/usr/bin/env python3.10

from argparse import ArgumentParser, Namespace
from requests import get
from time import perf_counter
from threading import Thread 
from colorama import Fore 

def get_directories(wordlist: str) -> list:
    with open(str(wordlist), 'r') as wordlist_file:
        directories = [line.replace('\n', '') for line in wordlist_file.readlines()]

    return directories


def parse_args() -> Namespace:
    parser = ArgumentParser(description="Directory-Enum.py URL LIST")
    parser.add_argument('url', help='URL')
    parser.add_argument('wordlist', help='Specify a wordlist')
    parser.add_argument('-v', '--verbose', help='verbose mode', action='store_true')
    return parser.parse_args()

def check_dir(dir_name: str) -> None:
    if args.verbose:
        print(f'{Fore.GREEN}\rtrying: {url}/{dir_name.lower()}{Fore.RESET}               ', end='')
    if get(f'{url}/{dir_name}').status_code != 404: #! if Found 
        print(f'\n{Fore.RED}{url}/{dir_name.lower()}{Fore.RESET}')
    
if __name__ == "__main__":
    start = perf_counter()
    args = parse_args()
    url = str(args.url).removesuffix('/')
    print(args.url)
    directories = get_directories(args.wordlist)

    for dir in directories:
        Thread(target=check_dir, args=[dir.lower()]).start()

    end = perf_counter()
    print(end-start)
    
